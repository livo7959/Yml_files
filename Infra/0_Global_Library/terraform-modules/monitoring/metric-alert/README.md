<!-- BEGIN_TF_DOCS -->

# `alerts`

This is an internal [Terraform](https://www.terraform.io/) module to create an [metric alert ](https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-types#metric-alerts) in [Microsoft Azure](https://azure.microsoft.com/en-us).

This module supports:

- Creating a metric alert with criteria, dynamic_criteria, and application_insights_web_test_location_availability_criteria blocks.
  - Criteria - Static thresholds
  - Dynamic Criteria - [Dynamic thresholds based on statistical analysis of historical data, rather than a static value](https://learn.microsoft.com/en-us/azure/azure-monitor/alerts/alerts-dynamic-thresholds)
  - Application Insights web test location availability - [Specifically used for Application Insights Web Tests to monitor availability from different locations](https://learn.microsoft.com/en-us/azure/azure-monitor/app/availability?tabs=standard#availability-alerts)

## Requirements

| Name                                                                     | Version |
| ------------------------------------------------------------------------ | ------- |
| <a name="requirement_terraform"></a> [terraform](#requirement_terraform) | >=1.9.0 |
| <a name="requirement_azurerm"></a> [azurerm](#requirement_azurerm)       | >=4.3.0 |

## Providers

| Name                                                         | Version |
| ------------------------------------------------------------ | ------- |
| <a name="provider_azurerm"></a> [azurerm](#provider_azurerm) | 4.3.0   |

## Modules

| Name                                                                                | Source                 | Version |
| ----------------------------------------------------------------------------------- | ---------------------- | ------- |
| <a name="module_common_constants"></a> [common_constants](#module_common_constants) | ../../common/constants | n/a     |

## Resources

| Name                                                                                                                                      | Type     |
| ----------------------------------------------------------------------------------------------------------------------------------------- | -------- |
| [azurerm_monitor_metric_alert.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_metric_alert) | resource |

## Inputs

| Name                                                                                                                                                                                                                  | Description                                                                                                                                                     | Type                                                                                                                                                                                                                                                                                                                                                                                                                                         | Default  | Required |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------- | :------: |
| <a name="input_action_group_id"></a> [action_group_id](#input_action_group_id)                                                                                                                                        | Action group ID                                                                                                                                                 | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                     | n/a      |   yes    |
| <a name="input_application_insights_web_test_location_availability_criteria"></a> [application_insights_web_test_location_availability_criteria](#input_application_insights_web_test_location_availability_criteria) | Optional but one of either criteria, dynamic_criteria or application_insights_web_test_location_availability_criteria must be specified                         | <pre>list(object({<br/> web_test_id = string<br/> component_id = string<br/> failed_location_count = number<br/> }))</pre>                                                                                                                                                                                                                                                                                                                   | `[]`     |    no    |
| <a name="input_auto_mitigate"></a> [auto_mitigate](#input_auto_mitigate)                                                                                                                                              | Should the alerts in this Metric Alert be auto resolved?                                                                                                        | `bool`                                                                                                                                                                                                                                                                                                                                                                                                                                       | `true`   |    no    |
| <a name="input_criteria"></a> [criteria](#input_criteria)                                                                                                                                                             | Optional but one of either criteria, dynamic_criteria or application_insights_web_test_location_availability_criteria must be specified                         | <pre>list(object({<br/> metric_namespace = string<br/> metric_name = string<br/> aggregation = string<br/> operator = string<br/> threshold = number<br/> dimension = optional(object({<br/> name = string<br/> operator = string<br/> values = list(string)<br/> }))<br/> }))</pre>                                                                                                                                                         | `[]`     |    no    |
| <a name="input_description"></a> [description](#input_description)                                                                                                                                                    | The description of the metric alert                                                                                                                             | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                     | `null`   |    no    |
| <a name="input_dynamic_criteria"></a> [dynamic_criteria](#input_dynamic_criteria)                                                                                                                                     | Optional but one of either criteria, dynamic_criteria or application_insights_web_test_location_availability_criteria must be specified                         | <pre>list(object({<br/> metric_namespace = string<br/> metric_name = string<br/> aggregation = string<br/> operator = string<br/> alert_sensitivity = string<br/> evaluation_total_count = number<br/> evaluation_failure_count = number<br/> ignore_data_before = string<br/> skip_metric_validation = bool<br/> dimension = optional(object({<br/> name = string<br/> operator = string<br/> values = list(string)<br/> }))<br/> }))</pre> | `[]`     |    no    |
| <a name="input_enabled"></a> [enabled](#input_enabled)                                                                                                                                                                | Whether the alert is enabled                                                                                                                                    | `bool`                                                                                                                                                                                                                                                                                                                                                                                                                                       | `true`   |    no    |
| <a name="input_frequency"></a> [frequency](#input_frequency)                                                                                                                                                          | The evaluation frequency of this Metric Alert, represented in ISO 8601 duration format. Possible values are PT1M, PT5M, PT15M, PT30M and PT1H. Defaults to PT1M | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                     | `"PT1M"` |    no    |
| <a name="input_name"></a> [name](#input_name)                                                                                                                                                                         | The name of the metric alert                                                                                                                                    | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                     | n/a      |   yes    |
| <a name="input_resource_group_name"></a> [resource_group_name](#input_resource_group_name)                                                                                                                            | Name of the resource group                                                                                                                                      | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                     | n/a      |   yes    |
| <a name="input_scopes"></a> [scopes](#input_scopes)                                                                                                                                                                   | A set of strings of resource IDs at which the metric criteria should be applied                                                                                 | `list(string)`                                                                                                                                                                                                                                                                                                                                                                                                                               | `[]`     |    no    |
| <a name="input_severity"></a> [severity](#input_severity)                                                                                                                                                             | The severity of the alert (0, 1, 2, 3, 4)                                                                                                                       | `number`                                                                                                                                                                                                                                                                                                                                                                                                                                     | `3`      |    no    |
| <a name="input_tags"></a> [tags](#input_tags)                                                                                                                                                                         | Tags of the Application Insights resource                                                                                                                       | `map(string)`                                                                                                                                                                                                                                                                                                                                                                                                                                | `{}`     |    no    |
| <a name="input_target_resource_location"></a> [target_resource_location](#input_target_resource_location)                                                                                                             | The location of the target resource                                                                                                                             | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                     | `null`   |    no    |
| <a name="input_target_resource_type"></a> [target_resource_type](#input_target_resource_type)                                                                                                                         | The resource type (e.g. Microsoft.Compute/virtualMachines) of the target resource                                                                               | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                     | `null`   |    no    |
| <a name="input_window_size"></a> [window_size](#input_window_size)                                                                                                                                                    | The size of the time window to evaluate over                                                                                                                    | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                     | `"PT5M"` |    no    |

## Outputs

No outputs.

<!-- END_TF_DOCS -->
